{% extends "base.html" %} {% block content %} {% load static %}
<main class="mt-5 pt-4">
  <div class="container dark-grey-text mt-5">
    <!--Grid row-->
    <div class="row wow fadeIn">
      <!--Grid column-->
      <div class="col-md-6 mb-4">
        <img src="{{ item.image.url }}" class="img-fluid" alt="" />
      </div>
      <!--Grid column-->

      <!--Grid column-->
      <div class="col-md-6 mb-4">
        <!--Content-->
        <div class="p-4">
          <div class="mb-3"></div>

          <p class="lead font-weight-bold">{{object.title}}</p>

          <p>{{object.description}}</p>
          <p class="lead">
            <span>
              ${% if item.discount_price %}
              <span class="mr-1">
                <del> {{object.price }} </del>
              </span>
              <span> ${{object.discount_price}} </span>
              {% else %}
              <span> {{ item.price }} </span>
              {% endif %}
            </span>
          </p>

          <select id="size_selector" name="size" required>
            <option value="none" selected disabled hidden>select size</option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>

          <button id="button" class="btn btn-primary btn-md my-0 p">
            Add to cart
            <i class="fas fa-shopping-cart ml-1"></i>
          </button>
        </div>
        <!--Content-->
      </div>
      <!--Grid column-->
    </div>
    <!--Grid row-->
  </div>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script>
    var token = "{{ csrf_token }}";
    const button = document.querySelector("#button");
    button.addEventListener("click", () => {
      var serializedData = $("select").serialize();
      $.ajax({
        headers: { "X-CSRFToken": token },
        type: "POST",
        url: "{% url 'core:product' item.slug %}",
        data: serializedData,
        success: function (response) {
          console.log(response);
        },
        error: function (response) {
          alert(response["responseJSON"]["error"]);
        },
      });
    });
  </script>
</main>
<!--Main layout-->

{% endblock content %}
